
# env-test
## Install
`git clone https://github.com/kequandian/env-test.git`  
`./init install`
## Usage

`./init get swagger <url>`
```
Usage: index <method> <api> [options] [value ...]

Options:
  -V, --version                          output the version number
  -o, --out
  -r, --report                           输出并记录日志
  -p, --parent
  --head
  --tail
  --notnull                              默认值, 仅生成notnull字段
  --all
  --table, <value>                       指定数据库表生成请求参数
  --swagger                              从swagger中获取字段信息生成请求参数, 默认值
  --filter <value>                       添加或替换生成参数 {key1:value1,key2:value2}
  --only                                 仅处理当前api，post/put请求后不带回get列表
  --pdf <inputFile> <outputFile>         生成pdf,指定需转换的文件位置
  -h, --help                             output usage information

Commands:
  login <endpoint> <account> <password>
  pdf <inputFile> <outputFile>
```

## Demo
### Base
```
$ env-test get api/cms/article/categories --out
+----------------------------------------------------------+
|                           data                           |
+─────────+───────+─────────────────────────+──────+───────+
| current │ pages │ records                 │ size │ total |
+─────────┼───────┼─────────────────────────┼──────┼───────+
| 1       │ 1     │ [{"allowImage":100,"... │ 10   │ 4     |
+---------+-------+-------------------------+------+-------+
+------------------------------------------------------+
|                     data#records                     |
+─────+────────────+───────────+────+─────────+────────+
| row │ allowImage │ fastEntry │ id │  name   │ typeId |
+─────┼────────────┼───────────┼────┼─────────┼────────+
| 0   │ 100        │ 9         │ 11 │ zy      │ 7057   |
+─────┼────────────┼───────────┼────┼─────────┼────────+
| 1   │ 44         │ 38        │ 24 │ hXRr>   │ 117    |
+─────┼────────────┼───────────┼────┼─────────┼────────+
| 2   │ 23         │ 104       │ 25 │ zli.<-3 │ 49     |
+─────┼────────────┼───────────┼────┼─────────┼────────+
| 3   │ 63         │ 93        │ 26 │ !H      │ 36     |
+-----+------------+-----------+----+---------+--------+
```
```
$ env-test post api/cms/article/categories --out --table=article_category
+----------------------------------------------------------+
|                           data                           |
+─────────+───────+─────────────────────────+──────+───────+
| current │ pages │ records                 │ size │ total |
+─────────┼───────┼─────────────────────────┼──────┼───────+
| 1       │ 1     │ [{"allowImage":100,"... │ 10   │ 5     |
+---------+-------+-------------------------+------+-------+
+-------------------------------------------------------------------------------------------------------------+
|                                                data#records                                                 |
+─────+────────────+───────────+────+────────────────────────────────────────────────────────────────+────────+
| row │ allowImage │ fastEntry │ id │                              name                              │ typeId |
+─────┼────────────┼───────────┼────┼────────────────────────────────────────────────────────────────┼────────+
| 0   │ 100        │ 9         │ 11 │ zy                                                             │ 7057   |
+─────┼────────────┼───────────┼────┼────────────────────────────────────────────────────────────────┼────────+
| 1   │ 44         │ 38        │ 24 │ hXRr>                                                          │ 117    |
+─────┼────────────┼───────────┼────┼────────────────────────────────────────────────────────────────┼────────+
| 2   │ 23         │ 104       │ 25 │ zli.<-3                                                        │ 49     |
+─────┼────────────┼───────────┼────┼────────────────────────────────────────────────────────────────┼────────+
| 3   │ 63         │ 93        │ 26 │ !H                                                             │ 36     |
+─────┼────────────┼───────────┼────┼────────────────────────────────────────────────────────────────┼────────+
| 4   │ 1          │ 0         │ 27 │ 8sMSk?&r~iV^_Sqw76*IcE#PIbq1>!GA7Mh*7boxYkTVdGI_KrpEc5z^A?b255 │ 29727  |
+-----+------------+-----------+----+----------------------------------------------------------------+--------+

```
```
$ env-test put api/cms/article/categories --out --table=article_category --tail --filter='{name:test}'
+----------------------------------------------------------+
|                           data                           |
+─────────+───────+─────────────────────────+──────+───────+
| current │ pages │ records                 │ size │ total |
+─────────┼───────┼─────────────────────────┼──────┼───────+
| 1       │ 1     │ [{"allowImage":100,"... │ 10   │ 5     |
+---------+-------+-------------------------+------+-------+
+------------------------------------------------------+
|                     data#records                     |
+─────+────────────+───────────+────+─────────+────────+
| row │ allowImage │ fastEntry │ id │  name   │ typeId |
+─────┼────────────┼───────────┼────┼─────────┼────────+
| 0   │ 100        │ 9         │ 11 │ zy      │ 7057   |
+─────┼────────────┼───────────┼────┼─────────┼────────+
| 1   │ 44         │ 38        │ 24 │ hXRr>   │ 117    |
+─────┼────────────┼───────────┼────┼─────────┼────────+
| 2   │ 23         │ 104       │ 25 │ zli.<-3 │ 49     |
+─────┼────────────┼───────────┼────┼─────────┼────────+
| 3   │ 63         │ 93        │ 26 │ !H      │ 36     |
+─────┼────────────┼───────────┼────┼─────────┼────────+
| 4   │ 1          │ 0         │ 27 │ test    │ 6283   |
+-----+------------+-----------+----+---------+--------+
```
```
$ env-test delete api/cms/article/categories --out --tail
+----------------------------------------------------------+
|                           data                           |
+─────────+───────+─────────────────────────+──────+───────+
| current │ pages │ records                 │ size │ total |
+─────────┼───────┼─────────────────────────┼──────┼───────+
| 1       │ 1     │ [{"allowImage":100,"... │ 10   │ 4     |
+---------+-------+-------------------------+------+-------+
+------------------------------------------------------+
|                     data#records                     |
+─────+────────────+───────────+────+─────────+────────+
| row │ allowImage │ fastEntry │ id │  name   │ typeId |
+─────┼────────────┼───────────┼────┼─────────┼────────+
| 0   │ 100        │ 9         │ 11 │ zy      │ 7057   |
+─────┼────────────┼───────────┼────┼─────────┼────────+
| 1   │ 44         │ 38        │ 24 │ hXRr>   │ 117    |
+─────┼────────────┼───────────┼────┼─────────┼────────+
| 2   │ 23         │ 104       │ 25 │ zli.<-3 │ 49     |
+─────┼────────────┼───────────┼────┼─────────┼────────+
| 3   │ 63         │ 93        │ 26 │ !H      │ 36     |
+-----+------------+-----------+----+---------+--------+
```
### Report
```
$ node index get api/cms/article/categories --report
+----------------------------------------------------------+
|                           data                           |
+─────────+───────+─────────────────────────+──────+───────+
| current │ pages │ records                 │ size │ total |
+─────────┼───────┼─────────────────────────┼──────┼───────+
| 1       │ 1     │ [{"allowImage":100,"... │ 10   │ 4     |
+---------+-------+-------------------------+------+-------+
+------------------------------------------------------+
|                     data#records                     |
+─────+────────────+───────────+────+─────────+────────+
| row │ allowImage │ fastEntry │ id │  name   │ typeId |
+─────┼────────────┼───────────┼────┼─────────┼────────+
| 0   │ 100        │ 9         │ 11 │ zy      │ 7057   |
+─────┼────────────┼───────────┼────┼─────────┼────────+
| 1   │ 44         │ 38        │ 24 │ hXRr>   │ 117    |
+─────┼────────────┼───────────┼────┼─────────┼────────+
| 2   │ 23         │ 104       │ 25 │ zli.<-3 │ 49     |
+─────┼────────────┼───────────┼────┼─────────┼────────+
| 3   │ 63         │ 93        │ 26 │ !H      │ 36     |
+-----+------------+-----------+----+---------+--------+

$ node index pdf pub/logs/2018-12-25.log demo.pdf
converting pdf from pub/logs/2018-12-25.log to demo.pdf
Done
```

